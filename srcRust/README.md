TODO: Rewrite in rust over the summer
